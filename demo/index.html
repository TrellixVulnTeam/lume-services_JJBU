
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://slaclab.github.io/lume-services/demo/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.5.2">
    
    
      
        <title>Demo - lume-services</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.9f9400aa.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#demo" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="lume-services" class="md-header__button md-logo" aria-label="lume-services" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            lume-services
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Demo
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/slaclab/lume-services" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link md-tabs__link--active">
        Overview
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../model_packaging/" class="md-tabs__link">
      Packaging
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../services/files/" class="md-tabs__link">
        Services
      </a>
    </li>
  

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../api/tasks/" class="md-tabs__link">
        API
      </a>
    </li>
  

  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../developer/setup/" class="md-tabs__link">
        Developer
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="lume-services" class="md-nav__button md-logo" aria-label="lume-services" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    lume-services
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/slaclab/lume-services" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_1">
          Overview
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Overview" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Overview
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        LUME-Services
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../config/" class="md-nav__link">
        Configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../model_packaging/" class="md-nav__link">
        Model Packaging
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../workflows/" class="md-nav__link">
        Workflows
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cli/" class="md-nav__link">
        CLI
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Demo
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Demo
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#package-a-model" class="md-nav__link">
    Package a model
  </a>
  
    <nav class="md-nav" aria-label="Package a model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-create-a-repository-for-your-project-on-github" class="md-nav__link">
    1. Create a repository for your project on GitHub
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-create-project" class="md-nav__link">
    2: Create project
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-configure-generated-repo-to-use-github-repo-as-the-origin" class="md-nav__link">
    3. Configure generated repo to use GitHub repo as the origin:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-set-up-model" class="md-nav__link">
    4. Set up model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-set-up-flow" class="md-nav__link">
    5. Set up flow
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-create-development-environment" class="md-nav__link">
    6. Create development environment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-set-up-tests" class="md-nav__link">
    7. Set up tests
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8-run-tests-with-github-actions" class="md-nav__link">
    8. Run tests with GitHub actions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9-configure-github-actions-build" class="md-nav__link">
    9. Configure GitHub actions build
  </a>
  
    <nav class="md-nav" aria-label="9. Configure GitHub actions build">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stanford-container-registry" class="md-nav__link">
    Stanford Container Registry
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dockerhub" class="md-nav__link">
    DockerHub
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10-create-a-release" class="md-nav__link">
    10. Create a release
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deploying-a-model-to-production" class="md-nav__link">
    Deploying a model to production:
  </a>
  
    <nav class="md-nav" aria-label="Deploying a model to production:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-start-services-with-docker-compose" class="md-nav__link">
    11. Start services with docker-compose
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-run-the-notebook-and-register-your-model" class="md-nav__link">
    12. Run the notebook and register your model
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../model_packaging/" class="md-nav__link">
        Packaging
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Services
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Services" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Services
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../services/files/" class="md-nav__link">
        File Service
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../services/results/" class="md-nav__link">
        Results DB Service
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../services/hpc/" class="md-nav__link">
        HPC Service
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../services/models/" class="md-nav__link">
        Modeling Service
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../services/scheduling/" class="md-nav__link">
        Scheduling Service
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="API" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_1" type="checkbox" id="__nav_4_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_1">
          Tasks
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tasks" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_1">
          <span class="md-nav__icon md-icon"></span>
          Tasks
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/tasks/" class="md-nav__link">
        Tasks
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" type="checkbox" id="__nav_4_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_2">
          Files
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Files" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Files
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/files/files/" class="md-nav__link">
        File
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/files/serializers/" class="md-nav__link">
        Serializers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/files/utils/" class="md-nav__link">
        Utils
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/models/" class="md-nav__link">
        Models
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/results/" class="md-nav__link">
        Results
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/config/" class="md-nav__link">
        Config
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/errors/" class="md-nav__link">
        Errors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/utils/" class="md-nav__link">
        Utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/flows/" class="md-nav__link">
        Flows
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/utils/" class="md-nav__link">
        Utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_10" type="checkbox" id="__nav_4_10" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_10">
          Services
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Services" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_10">
          <span class="md-nav__icon md-icon"></span>
          Services
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_10_1" type="checkbox" id="__nav_4_10_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_10_1">
          Results
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Results" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_10_1">
          <span class="md-nav__icon md-icon"></span>
          Results
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/services/results/results/" class="md-nav__link">
        Results Database Service
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/services/results/db/" class="md-nav__link">
        Database
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_10_2" type="checkbox" id="__nav_4_10_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_10_2">
          Files
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Files" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_10_2">
          <span class="md-nav__icon md-icon"></span>
          Files
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/services/files/files/" class="md-nav__link">
        File Service
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/services/files/filesystems/" class="md-nav__link">
        Filesystems
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_10_3" type="checkbox" id="__nav_4_10_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_10_3">
          Model
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Model" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_10_3">
          <span class="md-nav__icon md-icon"></span>
          Model
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/services/models/models/" class="md-nav__link">
        Model Database Service
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/services/models/db/" class="md-nav__link">
        Database
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_10_4" type="checkbox" id="__nav_4_10_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_10_4">
          Scheduling
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Scheduling" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_10_4">
          <span class="md-nav__icon md-icon"></span>
          Scheduling
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/services/scheduling/scheduling/" class="md-nav__link">
        Scheduling Service
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/services/scheduling/backends/" class="md-nav__link">
        Backends
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Developer
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Developer" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Developer
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../developer/setup/" class="md-nav__link">
        Setup
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../developer/documentation/" class="md-nav__link">
        Documentation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../developer/todo/" class="md-nav__link">
        TODO
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../developer/cluster/" class="md-nav__link">
        Cluster Architecture
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../developer/configuration/" class="md-nav__link">
        Configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../developer/docker_image/" class="md-nav__link">
        Docker Image
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <a href="https://github.com/slaclab/lume-services/edit/master/docs/demo.md" title="Edit this page" class="md-content__button md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>


<h1 id="demo">Demo</h1>
<p>This demo walks through the creation of a model compatible with <a href="https://slaclab.github.io/lume-services/">LUME-services</a> tooling. You will:</p>
<ol>
<li>Create a GitHub repository for the demo model  </li>
<li>Build a templated project using <a href="https://github.com/slaclab/lume-services-model-template"><code>lume-services-model-template</code></a>  </li>
<li>Register your model using the LUME-services API and store deployment information into a MySQL database  </li>
<li>Run your model, storing results in MongoDB database  </li>
<li>Retrieve model results using LUME-services  </li>
</ol>
<p>Requirements:  </p>
<ul>
<li><a href="https://github.com/">GitHub</a> account and <a href="https://docs.github.com/en/authentication/connecting-to-github-with-ssh/about-ssh">SSH keys</a> installed according to their instructions.  </li>
<li><a href="https://www.docker.com/products/docker-desktop/">Docker desktop</a> for launching the development environment  </li>
<li><a href="https://docs.conda.io/en/latest/miniconda.html">Conda installation</a> for the management of  Python environments  </li>
<li>Either a <a href="https://hub.docker.com/">DockerHub</a> account or Stanford account to use the <a href="https://itcommunity.stanford.edu/unconference/sessions/2018/introducing-scr-stanford-container-registry">Stanford Container Registry</a> provided by the <a href="https://code.stanford.edu/SiteDocs/faq">code.stanford.edu</a> effort.  </li>
</ul>
<h2 id="package-a-model">Package a model</h2>
<h3 id="1-create-a-repository-for-your-project-on-github">1. Create a repository for your project on GitHub</h3>
<p>Using your GitHub account, create an empty repository named <code>my-model</code> (feel free to sub this with whatever you'd like).</p>
<h3 id="2-create-project">2: Create project</h3>
<p>Clone <code>lume-services-model-template</code> and navigate to repository:
<div class="highlight"><pre><span></span><code>git clone https://github.com/slaclab/lume-services-model-template
cd lume-services-model-template
</code></pre></div></p>
<p>Create your environment:</p>
<div class="highlight"><pre><span></span><code>conda env create -f environment.yml
conda activate lume-services-model-template
</code></pre></div>
<p>Create your project. The <code>-o</code> flag indicates the directory where you'd like the resulting repo to be stored. For now, let's create it in the repo root:
<div class="highlight"><pre><span></span><code>cookiecutter template -o $(pwd)
</code></pre></div></p>
<p>Answer the prompts
<div class="highlight"><pre><span></span><code>author: &lt;your name&gt;
email: &lt;your email address&gt;
github_username: &lt;your GitHub username&gt;
github_url: &lt;url of GitHub repo you&#39;ve just created&gt;
project_name: My Model
</code></pre></div>
Use autogenerated in brackets by just pressing enter.
<div class="highlight"><pre><span></span><code>repo_name [my-model]:
package [my_model]:
model_class [MyModel]:
</code></pre></div></p>
<p><div class="highlight"><pre><span></span><code>Select container_registry:
1 - DockerHub
2 - Stanford Container Registry
Choose from 1, 2 [1]:
</code></pre></div>
If you plan to use the Stanford Container Registry, enter <code>2</code>. Otherwise, enter <code>1</code> for DockerHub. Now, enter the username you use for the contaner registry:</p>
<div class="highlight"><pre><span></span><code>container_username: &lt;your registry username&gt; 
</code></pre></div>
<p>Use example variables file packaged with this repository. This requires the full path to the file as the hook runs in the root of the generated project and cannot reference the context of the execution directory.
<div class="highlight"><pre><span></span><code>model_config_file: /full/path/to/lume-services-model-template/examples/variables.yml
</code></pre></div></p>
<p>Cookiecutter will render a repository using the template with the structure:</p>
<p><div class="highlight"><pre><span></span><code>my-model
├── Dockerfile
├── MANIFEST.in
├── README.md
├── _entrypoint.sh
├── conftest.py
├── dev-environment.yml
├── environment.yml
├── my_model
│   ├── __init__.py
│   ├── _image.py
│   ├── _version.py
│   ├── files
│   │   ├── __init__.py
│   │   └── variables.yml
│   ├── flow.py
│   ├── model.py
│   └── tests
│       ├── __init__.py
│       └── test_flow.py
├── pytest.ini
├── requirements.txt
├── setup.cfg
├── setup.py
└── versioneer.py
</code></pre></div>
You can generate this tree from your generated project by running:
<div class="highlight"><pre><span></span><code>tree my-model
</code></pre></div></p>
<p>Now, navigate to the directory where you've created your repository:
<div class="highlight"><pre><span></span><code>cd my-model
</code></pre></div></p>
<h3 id="3-configure-generated-repo-to-use-github-repo-as-the-origin">3. Configure generated repo to use GitHub repo as the origin:</h3>
<p>Replace username and brackets in the below command:
<div class="highlight"><pre><span></span><code>git remote add origin git@github.com:&lt;your GitHub username&gt;/my-model.git
git push --set-upstream -f origin main
</code></pre></div></p>
<p>Note: If your local git configuration defaults to creating a branch with name <code>master</code>, you'll have to rename the local branch to main using:
<div class="highlight"><pre><span></span><code>git branch -m master main
</code></pre></div></p>
<h3 id="4-set-up-model">4. Set up model</h3>
<p>Replace ellipses in the <code>evaluate</code> method of <code>my_model/model.py</code> with:
<div class="highlight"><pre><span></span><code><span class="bp">self</span><span class="o">.</span><span class="n">output_variables</span><span class="p">[</span><span class="s2">&quot;output1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span>
    <span class="n">input_variables</span><span class="p">[</span><span class="s2">&quot;input1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>  <span class="c1"># lower dist bound</span>
    <span class="n">input_variables</span><span class="p">[</span><span class="s2">&quot;input2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>  <span class="c1"># upper dist bound</span>
    <span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>
<span class="p">)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">output_variables</span><span class="p">[</span><span class="s2">&quot;output2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">input_variables</span><span class="p">[</span><span class="s2">&quot;input1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
<span class="bp">self</span><span class="o">.</span><span class="n">output_variables</span><span class="p">[</span><span class="s2">&quot;output3&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">input_variables</span><span class="p">[</span><span class="s2">&quot;input2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
</code></pre></div></p>
<p>Because we've introduced numpy as new dependency, add a numpy import to the top of the file so the model.py file looks like:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Dict</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">lume_model.models</span> <span class="kn">import</span> <span class="n">BaseModel</span>
<span class="kn">from</span> <span class="nn">lume_model.variables</span> <span class="kn">import</span> <span class="n">InputVariable</span><span class="p">,</span> <span class="n">OutputVariable</span>
<span class="kn">from</span> <span class="nn">my_model</span> <span class="kn">import</span> <span class="n">INPUT_VARIABLES</span><span class="p">,</span> <span class="n">OUTPUT_VARIABLES</span>

<span class="k">class</span> <span class="nc">MyModel</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">input_variables</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">INPUT_VARIABLES</span><span class="p">)</span>
    <span class="n">output_variables</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">OUTPUT_VARIABLES</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">settings_kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the model. If additional settings are required, they can be</span>
<span class="sd">        passed and handled here. For models that are wrapping model loads</span>
<span class="sd">        from other frameworks, this can be used for loading weights, referencing</span>
<span class="sd">        data files, etc.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="c1"># handle settings if any</span>
        <span class="c1"># if settings_kwargs is not None:</span>
        <span class="c1"># ...</span>


    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">input_variables</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">InputVariable</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">OutputVariable</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;The evaluate method accepts input variables, performs the model execution,</span>
<span class="sd">        then returns a dictionary mapping variable name to output variable.</span>

<span class="sd">        Args:</span>
<span class="sd">            input_variables (Dict[str, InputVariable]): Dictionary of LUME-model input</span>
<span class="sd">                variables with values assigned.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict[str, OutputVariable]: Dictionary of LUME-model output variables with</span>
<span class="sd">                values assigned.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">output_variables</span><span class="p">[</span><span class="s2">&quot;output1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span>
            <span class="n">input_variables</span><span class="p">[</span><span class="s2">&quot;input1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>  <span class="c1"># lower dist bound</span>
            <span class="n">input_variables</span><span class="p">[</span><span class="s2">&quot;input2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>  <span class="c1"># upper dist bound</span>
            <span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_variables</span><span class="p">[</span><span class="s2">&quot;output2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">input_variables</span><span class="p">[</span><span class="s2">&quot;input1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_variables</span><span class="p">[</span><span class="s2">&quot;output3&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">input_variables</span><span class="p">[</span><span class="s2">&quot;input2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>


        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_variables</span>
</code></pre></div>
<p>Add <code>numpy</code> to the <code>dev-environment.yml</code>, <code>environment.yml</code>, and <code>requirements.txt</code> files.</p>
<h3 id="5-set-up-flow">5. Set up flow</h3>
<p>In order for our flow to run, we must edit the code in <code>my_model/flow.py</code>. First, delete the <code>preprocessing_task</code> code, as we won't be using it. Second, edit <code>format_file</code> such that the file holds a string representation of the sum of <code>output2</code> and <code>output3</code>.</p>
<div class="highlight"><pre><span></span><code><span class="nd">@task</span><span class="p">(</span><span class="n">log_stdout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">format_file</span><span class="p">(</span><span class="n">output_variables</span><span class="p">):</span>
    <span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">output_variables</span><span class="p">[</span><span class="s2">&quot;output2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">+</span> <span class="n">output_variables</span><span class="p">[</span><span class="s2">&quot;output3&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">text</span>
</code></pre></div>
<h3 id="6-create-development-environment">6. Create development environment</h3>
<p>Now, create an environment for working with your model package:</p>
<div class="highlight"><pre><span></span><code>conda env create -f dev-environment.yml
conda activate my-model-dev
</code></pre></div>
<p>Install your package into this environment:
<div class="highlight"><pre><span></span><code>pip install -e .
</code></pre></div></p>
<h3 id="7-set-up-tests">7. Set up tests</h3>
<p>In <code>my_model/tests/test_flow.py</code> modify the <code>test_flow_execution</code> function, adding the <code>tmp_path</code> fixture to the signature and passing <code>filename=f"{tmp_dir}/test_file.txt"</code> and <code>filesytem_identifier="local"</code> to the run method. The resulting code should look like:</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">test_flow_execution</span><span class="p">(</span><span class="n">tmp_path</span><span class="p">):</span>
    <span class="n">flow</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tmp_path</span><span class="si">}</span><span class="s2">/test_file.txt&quot;</span><span class="p">,</span> <span class="n">filesystem_identifier</span><span class="o">=</span><span class="s2">&quot;local&quot;</span><span class="p">)</span>
</code></pre></div>
<p>Navigate back to your <code>my-model</code> directory. You can now test your flow locally by running:
<div class="highlight"><pre><span></span><code>pytest .
</code></pre></div></p>
<h3 id="8-run-tests-with-github-actions">8. Run tests with GitHub actions</h3>
<p>Check in all of your code, and push to GitHub.</p>
<div class="highlight"><pre><span></span><code>git add .
git commit -m &quot;Check in formatted repo&quot;
git push
</code></pre></div>
<p>In your browser, navigate to your GitHub repository at <code>https://github.com/&lt;your GitHub username&gt;/my-model/actions</code>. The testing workflow configured in <code>.github/workflows/tests.yml</code> will run automatically on pushes to your main branch and you can monitor the success of these tests from the GitHub actions console for the repo. The workflow tests your package against a matrix of Python versions (3.7, 3.8, 3.9) on the latest Ubuntu build. You can expand this matrix if desired using <a href="https://docs.github.com/en/actions/using-jobs/using-a-matrix-for-your-jobs">GitHub actions matrix options</a>.</p>
<h3 id="9-configure-github-actions-build">9. Configure GitHub actions build</h3>
<h4 id="stanford-container-registry">Stanford Container Registry</h4>
<p>SLAC users can take advantage of the <a href="https://itcommunity.stanford.edu/unconference/sessions/2018/introducing-scr-stanford-container-registry">Stanford Container Registry</a> to store their containers. The steps for configuring your project to use the registry are as follows:</p>
<p><strong>9.1</strong> Create an API token at https://code.stanford.edu/-/profile/personal_access_tokens. For <code>Token name</code> enter <code>My Model</code>. Optionally choose an expiration date. This can be whatever you'd like, but the GitHub action secret defined in step 3. will need to be updated with a new value after this expiration. Record this API token for use in steps 9.3 and 9.4.</p>
<p><img alt="token" src="../files/PAT.png" /></p>
<p><strong>9.2</strong> Create a project using <a href="https://code.stanford.edu/projects/new#blank_project">Stanford Code</a>. In the <code>Project name</code> field, write <code>My Model</code>. Select internal visibility level.</p>
<p><img alt="project" src="../files/scr_project.png" /></p>
<p><strong>9.3</strong> Add the token to your GitHub repository secrets. Navigate to your repository settings. In the left sidebar, click <code>Secrets</code>, <code>Actions</code>, then <code>New repository secret</code>. Type <code>SCR_PAT</code> into the name, and your generated API key into the value. Repeat this process to set a secret named <code>STANFORD_USERNAME</code> to your Stanford username.</p>
<p><strong>9.4</strong> Login to the container registry on your machine.</p>
<p>Replace the &lt;&gt; with the appropriate values:</p>
<div class="highlight"><pre><span></span><code>echo &lt;your token&gt; | docker login --username &lt;your Stanford username&gt; --password-stdin http://scr.svc.stanford.edu
</code></pre></div>
<h4 id="dockerhub">DockerHub</h4>
<p>The LUME-services model template is pre-configured to publish the container image to DockerHub. In order to use this workflow, authentication for the repository must be configured using <a href="https://docs.github.com/en/actions/security-guides/encrypted-secrets">GitHub secrets</a>.</p>
<ol>
<li>Navigate to the settings on your repository.  </li>
</ol>
<p><img alt="settings" src="../files/repo-actions-settings.png" /></p>
<ol>
<li>In the left sidebar, click <code>Secrets</code>, <code>Actions</code>, then <code>New repository secret</code>. Type <code>DOCKER_USERNAME</code> into the name, and your DockerHub username into the value and click <code>Add secret</code> to save. Repeat this process to create a <code>DOCKER_PASSWORD</code> secret with your DockerHub password as the value.  </li>
</ol>
<h3 id="10-create-a-release">10. Create a release</h3>
<p>Create a tagged release for your model. Navigate to <code>https://github.com/&lt;your GitHub username&gt;/my-model/releases</code> -&gt; <code>Draft a new release</code></p>
<p><img alt="draft_release" src="../files/draft_new_release.png" /></p>
<p>Under choose tag, type <code>v0.0.1</code> (this is a development tag, <a href="https://semver.org/">semantic versioning</a> for releases formally starts at v0.1). You can enter the same for the title and may enter some description, but this is optional. Check the pre-release box at the bottom of the page and click the button to publish your release.</p>
<p>The release will trigger a GitHub action workflow for your project, which you can monitor at <code>https://github.com/&lt;your GitHub username&gt;/my-model/actions</code>. Once the build completes, your image will be available at <code>https://hub.docker.com/u/&lt;your DockerHub username&gt;</code> or <code>https://code.stanford.edu/&lt;your Stanford username&gt;/my-model/container_registry</code>.</p>
<h2 id="deploying-a-model-to-production">Deploying a model to production:</h2>
<p>The below steps mimic a production deployment workflow.</p>
<h3 id="11-start-services-with-docker-compose">11. Start services with docker-compose</h3>
<p>LUME-services is packaged with a command line utility for launching the development environment, a docker-compose application with all services packaged and configurable via environment variables.</p>
<p><img alt="docker" src="../files/docker_architecture.png" /></p>
<p>Create a new console window. If you haven't, clone the lume-services repository.
<div class="highlight"><pre><span></span><code>git clone https://github.com/jacquelinegarrahan/lume-services
</code></pre></div>
Navigate to your local <code>lume-services</code> repository and activate your environment. 
<div class="highlight"><pre><span></span><code>cd lume-services
conda activate my-model-dev
</code></pre></div></p>
<p>Configure your environment variables.</p>
<div class="highlight"><pre><span></span><code>source docs/examples/demo.env
</code></pre></div>
<p>If you are using the Stanford Container Registry, you'll have to set additional environment variables, you <code>STANFORD_USERNAME</code> and <code>SCR_PAT</code> from step 9.
<div class="highlight"><pre><span></span><code>export STANFORD_USERNAME=&lt;your_stanford_username&gt;
export SCR_PAT=&lt;your PAT from step 9&gt;
</code></pre></div></p>
<p>Next start up your services:
<div class="highlight"><pre><span></span><code>lume-services docker start-services
</code></pre></div></p>
<p>If you have existing services running on the ports defined in <code>docs/examples/demo.env</code>, you may need to edit the file to use free ports.  </p>
<p>Once the console logs a message about passed health checks, you've started all services successfully. You can inspect the services using Docker Desktop:</p>
<p><img alt="desktop" src="../files/docker_desktop.png" /></p>
<p>And access the UI using your browser at <a href="http://localhost:8080">http://localhost:8080</a>.</p>
<h3 id="12-run-the-notebook-and-register-your-model">12. Run the notebook and register your model</h3>
<p>Create a new console window. Navigate to your local <code>lume-services</code> repository and activate your environment. 
<div class="highlight"><pre><span></span><code>cd lume-services
conda activate my-model-dev
</code></pre></div>
Source the appropriate environment:</p>
<p><div class="highlight"><pre><span></span><code>source docs/examples/demo.env
</code></pre></div>
Open the demo notebook and continue the remainder of the demo by running each cell:
<div class="highlight"><pre><span></span><code>jupyter notebook docs/examples/Demo.ipynb
</code></pre></div></p>





                
              </article>
            </div>
          
          
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../cli/" class="md-footer__link md-footer__link--prev" aria-label="Previous: CLI" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              CLI
            </div>
          </div>
        </a>
      
      
        
        <a href="../model_packaging/" class="md-footer__link md-footer__link--next" aria-label="Next: Packaging" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Packaging
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["toc.integrate", "toc.follow", "navigation.top", "navigation.tabs"], "search": "../assets/javascripts/workers/search.ecf98df9.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.39f04ddb.min.js"></script>
      
    
  </body>
</html>